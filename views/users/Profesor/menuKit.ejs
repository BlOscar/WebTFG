<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style.css">

</head>
<body>
    

    <div class="container-grid container">
    <a href="/menu" class="btn-redirect">Regresar a menu</a>
    <% if(canEliminate){%>
        <button onclick="eliminatekit(<%=kit.id%>)" class="btn-redirect" style="background-color: brown; color:lightgray">Eliminar kit</button>
        <script>
            
            async function eliminatekit(id){
                debugger;
                const res = await fetch("/kit/api/removeKit",{
                    method:"DELETE",
                    headers:{
                    "Content-Type":"application/json"
                    },
                    body: JSON.stringify({
                        idKit: id
                    })
                });
                if(res.ok){
                    window.location.href = "/menu";
                }else{
                    const response = await res.json();
                    alert("Ha habido un error durante la eliminación: " + response.error);
                }
            }
    

        </script>
    <%}%>
        <h2>Kit:</h2>
        <h5>Nombre: <%= kit.name %></h5>
        <h5>Necesidades: <a href="/<%= kit.objetive %>">Ver Archivo</a></h5>
        <h5>Historias de Usuario: </h5>

        <div class="scroll-container" style="padding: 10px; margin-bottom: 20px;">
            <table>
                <tbody>
                <% if(HUList.length != 0){ %>
                
                    <% HUList.forEach (hu => { %>
                        <tr>
                            <td>
        
                            <h6>Nombre: <%= hu.name %></h6>
                            <h6>Necesidades: <%= hu.description%></h6>
                            <img src="/<%=hu.imageUrl%>" />
    
                            </td>
                        </tr>
                    <% }); %>
                <% } %>

               
                </tbody>
            </table>

        </div>
        <a href="/kit/addHU" class="btn-redirect">Add HU</a>
        <h5>Cajas: </h5>

            <table>
                <tr>
                    <th>Nombre </th>
                    <th>Manuales</th>
                </tr>
                <% if(boxLego.length != 0){ %>
                    <% boxLego.forEach (box => { %>
                        <tr>
                            <td>
                            <h6><%= box.name %> </h6>
                            </td>
                        
                            <% if(box.manualBoxes.length !=0){
                                box.manualBoxes.forEach(e=>{ %>
                                <td>

                                <h6>manual enlace:
                                 <a href="/<%= e.urlPDF %>"> <%= e.name %></a>
                                </h6>
                        
    
                                </td>
                            <% }); 
                            }else{ %>
                                <td><h6>No hay ningún manual</h6></td>
                            <% } %>
                            </tr>
                        
                    <% }); %>
                <% } %>
               

            </table>
        <a href="/kit/addBox" class="btn-redirect">Add Box</a>

    </div>
</body>